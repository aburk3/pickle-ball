<div class="text-center">
  <h1 class="postTitle"><%= @post.title %></h1>
  <%= link_to(@post.user) do %>
    <strong class="postUser">by: <%= @post.user.first_name %> <%= @post.user.last_name %></strong>
  <% end %>
  <br>
  <p class="postCreated"><%= @post.created_at %></p>
  <ul class="list-inline">
    <li class="list-inline-item">


        <%= button_to 'Unlike', post_like_path(@post, pre_like), method: :delete %>

        <%= button_to 'Like', post_likes_path(@post), method: :post %>

    </li>
    <li class="list-inline-item">
      <p class="postLikes"><%= @post.likes.length %> </p>
    </li>
  </ul>
</div>


<div>
  <p class="lead postContent">
    <br> <%= @post.content %>
  </p>
  <br>
</div>

<hr>

<section class="section">
	<div class="container">
		<nav class="level">
		  <!-- Left side -->
		  <div class="level-left">
		  </div>
		  <!-- Right side -->
		  <div class="level-right">

  		  	<p class="level-item">
  		    	<%= link_to "Edit", edit_post_path(@post), class:"button" %>
  		  	</p>
  		  	<p class="level-item">
          <%= button_to 'Delete Post', { :controller => "posts", :action => "destroy", :post_id => @post.id, :user_id=> session[:user_id] }, :method=>:delete, data: { confirm: "Are you sure you want to delete this Post?" }, class: 'btn btn-danger' %>
  				</p>

		  </div>
		</nav>
	</div>
</section>


  <section class="section comments">
  	<div class="container">
  		<h2 class="subtitle is-5"><strong><%= @post.comments.count %></strong> Comments</h2>
  		<%= render @post.comments %>
  		<div class="comment-form">
  			<hr />
  			<h3 class="subtitle is-3">Leave a reply</h3>
  	 		<%= render 'comments/form' %>
  		</div>
  	</div>
  </section>



  <a href="#" class="js-next" data-id="<%=@post.id%>">Next Post</a>

  <script type="text/javascript" charset="utf-8">
  $(function () {
    $(".js-next").on("click", function() {
      var nextId = parseInt($(".js-next").attr("data-id")) + 1;
      $.get("/posts/" + nextId + ".json", function(data) {

        // Attempted to change the url without reloading
        // document.getElementById("content").innerHTML = data.html;
        // document.title = data.pageTitle;
        // window.history.pushState({"html":data.html,"pageTitle":data.pageTitle},"", urlPath);
        console.log(data);
        $(".postTitle").text(data["title"]);
        $(".postLikes").text(data["likes"].length);
        $(".postContent").text(data["content"]);
        $(".postUser").text(data.user.first_name + data.user.last_name);
        $(".postCreated").text(data.user.created_at);
        // re-set the id to current on the link
        $(".js-next").attr("data-id", data["id"]);
      });
    });
  });
  </script>
